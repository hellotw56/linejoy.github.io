<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LINE LIFF Prank</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        button { display: block; width: 60%; padding: 15px; margin: 10px auto; font-size: 18px; }
    </style>
</head>
<body>
    <button id="btnShare3" onclick="sendShare_Pay()" style="display: none;">Pay</button>
    <button id="btnLogin" onclick="liff.login()" style="display: none;">Log In</button>
    <button id="btnLogOut" onclick="logOut()" style="display: none;">Log Out</button>

    <script>
        async function main() {
            await liff.init({ liffId: "2006886128-0XBE3yO7" });
            if (liff.isLoggedIn()) {
                document.getElementById("btnShare3").style.display = "block";
                if (!liff.isInClient()) {
                    document.getElementById("btnLogOut").style.display = "block";
                }
            } else {
                document.getElementById("btnLogin").style.display = "block";
            }
        }

        async function sendShare_Pay() {
            name = await liff.getProfile().then((profile) => {
                return profile.displayName;
            }).catch((err) => {
                return err;
            });
            const result = await liff.shareTargetPicker([
                {
                    "type": "flex",
                    "altText": "已收到NT$ 520的轉帳。",
                    "contents": {
                        "type": "bubble",
                        "size": "hecto",
                        "hero": {
                            "type": "image",
                            "url": "https://i.imgur.com/j5VkCxE.png",
                            "size": "full",
                            "aspectRatio": "20:13",
                            "aspectMode": "cover",
                            "action": {
                                "type": "uri",
                                "uri": "https://liff.line.me/1657022499-njBkN1k3?auto=yes&type=text&text=%E6%88%91%E8%B6%85%E7%AC%A8%20%E6%B4%BB%E8%A9%B2%E8%A2%AB%E9%A8%99"
                            }
                        },
                        "body": {
                            "type": "box",
                            "layout": "vertical",
                            "contents": [
                                {
                                    "type": "text",
                                    "text": "LINE Pay",
                                    "weight": "bold",
                                    "size": "xs"
                                },
                                {
                                    "type": "text",
                                    "text": "您已收到 NT$ 520。（來自：" + name + "）",
                                    "size": "xs",
                                    "color": "#8E8E8E"
                                },
                                {
                                    "type": "button",
                                    "style": "secondary",
                                    "height": "sm",
                                    "margin": "lg",
                                    "color": "#F0F0F0",
                                    "action": {
                                        "type": "uri",
                                        "label": "瞭解更多",
                                        "uri": "https://liff.line.me/1657022499-njBkN1k3?auto=yes&type=text&text=%E6%88%91%E8%B6%85%E7%AC%A8%20%E6%B4%BB%E8%A9%B2%E8%A2%AB%E9%A8%99"
                                    }
                                }
                            ]
                        },
                        "footer": {
                            "type": "box",
                            "layout": "baseline",
                            "contents": [
                                {
                                    "type": "icon",
                                    "url": "https://i.imgur.com/LriSrg0.png",
                                    "size": "xs"
                                },
                                {
                                    "type": "text",
                                    "text": "LINE Pay",
                                    "size": "xxs",
                                    "color": "#8E8E8E"
                                },
                                {
                                    "type": "icon",
                                    "url": "https://i.imgur.com/aKbXQ9D.png",
                                    "size": "xxs"
                                }
                            ]
                        }
                    }
                }
            ]);

            if (result) {
                alert(`[${result.status}] Message sent!`);
            } else {
                alert('ShareTargetPicker was canceled');
            }
        }

        function logOut() {
            liff.logout();
            location.reload();
        }

        main();
    </script>
</body>
</html>
